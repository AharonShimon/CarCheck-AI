<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>CarCheck AI Pro</title>
    <style>
        :root { 
            --bg-dark: #0B0E14; 
            --bg-panel: #151A25; 
            --primary: #00F0FF; 
            --primary-dim: rgba(0, 240, 255, 0.15);
            --text-main: #FFFFFF;
            --text-muted: #8A9BB1;
            --border: #2A3B55;
            --success: #00FF94; 
            --warning: #FFB800; 
            --danger: #FF3B3B; 
        }

        body { 
            font-family: 'Segoe UI', system-ui, sans-serif; 
            background-color: var(--bg-dark);
            background-image: radial-gradient(circle at 50% 0%, #1a253a 0%, var(--bg-dark) 70%);
            color: var(--text-main); 
            margin: 0; direction: rtl; 
            -webkit-tap-highlight-color: transparent;
            min-height: 100vh;
        }

        .container { padding: 20px; max-width: 480px; margin: auto; padding-bottom: 90px; }

        h1 { font-weight: 800; text-align: center; margin-bottom: 25px; text-transform: uppercase; }
        h1 span { color: var(--primary); text-shadow: 0 0 15px var(--primary-dim); }

        /* ×œ×•×—×™×ª ×¨×™×©×•×™ */
        .plate-container { 
            background: #FFC400; padding: 3px; border-radius: 8px; 
            box-shadow: 0 0 20px rgba(255, 196, 0, 0.2);
            margin-bottom: 25px; transform: skew(-2deg);
        }
        .plate-inner { border: 2px solid black; border-radius: 6px; display: flex; align-items: center; padding: 5px; }
        .plate-input { 
            background: none; border: none; font-size: 42px; font-weight: 800; width: 100%; 
            text-align: center; outline: none; letter-spacing: 6px; font-family: monospace; color: #000;
            transform: skew(2deg);
        }
        .il-tag { 
            background: #003399; color: white; padding: 4px 10px; border-radius: 4px; 
            font-size: 12px; font-weight: bold; line-height: 1; margin-left: 10px; transform: skew(2deg);
        }

        /* ×˜×¤×¡×™× */
        label { color: var(--text-muted); font-size: 14px; margin-bottom: 8px; display: block; font-weight: 500; }
        
        select, input, .year-display { 
            width: 100%; padding: 16px; background: var(--bg-panel); 
            border: 1px solid var(--border); color: #fff; border-radius: 12px; 
            margin-bottom: 20px; font-size: 16px; box-sizing: border-box; 
            transition: 0.3s all; appearance: none;
        }
        
        select {
            background-image: url("data:image/svg+xml;charset=US-ASCII,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22292.4%22%20height%3D%22292.4%22%3E%3Cpath%20fill%3D%22%2300F0FF%22%20d%3D%22M287%2069.4a17.6%2017.6%200%200%200-13-5.4H18.4c-5%200-9.3%201.8-12.9%205.4A17.6%2017.6%200%200%200%200%2082.2c0%205%201.8%209.3%205.4%2012.9l128%20127.9c3.6%203.6%207.8%205.4%2012.8%205.4s9.2-1.8%2012.8-5.4L287%2095c3.5-3.5%205.4-7.8%205.4-12.8%200-5-1.9-9.2-5.5-12.8z%22%2F%3E%3C%2Fsvg%3E");
            background-repeat: no-repeat; background-position: left 15px center; background-size: 10px;
        }

        select:focus, input:focus, .year-display:focus { border-color: var(--primary); box-shadow: 0 0 15px var(--primary-dim); outline: none; }

        .btn { 
            background: linear-gradient(135deg, #00C2FF 0%, #007AFF 100%);
            border: none; font-size: 18px; color: white; font-weight: 700;
            cursor: pointer; padding: 16px; border-radius: 12px; width: 100%;
            box-shadow: 0 4px 15px rgba(0, 122, 255, 0.4);
        }
        .btn-ai { background: linear-gradient(135deg, var(--primary) 0%, #0099FF 100%); color: #000; margin-top: 10px; box-shadow: 0 0 20px rgba(0, 240, 255, 0.3); }

        /* Year Picker */
        .year-picker-wrapper { position: relative; margin-bottom: 20px; }
        .year-popup {
            display: none; position: absolute; top: 105%; right: 0; left: 0;
            background: #1A202C; border: 1px solid var(--border); border-radius: 12px;
            padding: 15px; z-index: 100; box-shadow: 0 20px 50px rgba(0,0,0,0.5);
        }
        .year-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; color: var(--text-muted); }
        .year-nav { cursor: pointer; padding: 5px 15px; font-weight: bold; color: var(--primary); font-size: 18px; }
        .year-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; }
        .year-cell { padding: 12px; text-align: center; background: var(--bg-dark); border-radius: 8px; cursor: pointer; color: #fff; }
        .year-cell:hover { border: 1px solid var(--primary); }
        .year-cell.selected { background: var(--primary); color: #000; font-weight: bold; }

        /* Loader & Results */
        #loader { display: none; position: fixed; inset: 0; background: rgba(11, 14, 20, 0.95); z-index: 9999; flex-direction: column; align-items: center; justify-content: center; }
        .spinner { width: 50px; height: 50px; border: 3px solid rgba(0, 240, 255, 0.2); border-top-color: var(--primary); border-radius: 50%; animation: spin 1s infinite linear; }
        @keyframes spin { to { transform: rotate(360deg); } }
        
        #ai-result { display: none; margin-top: 25px; }
        .ai-gauge { width: 100px; height: 100px; border-radius: 50%; border: 6px solid #2A3B55; display: flex; align-items: center; justify-content: center; font-size: 36px; font-weight: 800; margin: 0 auto 15px auto; background: var(--bg-panel); }
        .ai-card { background: var(--bg-panel); padding: 18px; border-radius: 12px; border-right: 4px solid #555; margin-bottom: 12px; }
        .ai-card ul { padding-right: 20px; color: var(--text-muted); }
        .card-bad { border-right-color: var(--danger); } .card-bad h3 { color: var(--danger); margin: 0; }
        .card-good { border-right-color: var(--success); } .card-good h3 { color: var(--success); margin: 0; }
        .card-info { border-right-color: var(--primary); } .card-info h3 { color: var(--primary); margin: 0; }

        /* Checklist & Overlay */
        .check-item { background: var(--bg-panel); padding: 15px; border-radius: 12px; margin-top: 10px; display: flex; justify-content: space-between; align-items: center; border: 1px solid var(--border); }
        .cb { width: 24px; height: 24px; border: 2px solid #555; border-radius: 6px; margin-left: 15px; }
        .cb.checked { background: var(--primary); border-color: var(--primary); }
        #score-overlay { display: none; position: fixed; inset: 0; background: rgba(11, 14, 20, 0.98); z-index: 2000; flex-direction: column; align-items: center; justify-content: center; text-align: center; padding: 25px; }
        .score-circle { width: 160px; height: 160px; border-radius: 50%; border: 8px solid var(--success); display: flex; align-items: center; justify-content: center; font-size: 60px; font-weight: 900; color: var(--success); margin-bottom: 25px; }
    </style>
</head>
<body>

<div id="loader">
    <div class="spinner"></div>
    <p style="color:var(--primary); margin-top:20px; font-weight:600;">×× ×ª×— × ×ª×•× ×™×...</p>
</div>

<div id="screen-input" class="container">
    <h1>CarCheck <span>AI</span></h1>
    
    <div class="plate-container">
        <div class="plate-inner">
            <div class="il-tag"><span>×™×©×¨××œ</span><span>IL</span></div>
            <input id="plate" class="plate-input" type="tel" placeholder="12345678" maxlength="8">
        </div>
    </div>
    
    <button class="btn" onclick="superSearch()">ğŸ” ××™×ª×•×¨ ×¨×›×‘ (×××©×œ×ª×™)</button>
    <div id="status-msg" style="text-align:center; min-height:20px; font-weight:bold; margin-top:15px;"></div>

    <div style="margin-top:30px;">
        <label>×™×¦×¨×Ÿ</label>
        <select id="brand" onchange="updateModels()">
            <option value="">×‘×—×¨ ×™×¦×¨×Ÿ...</option>
        </select>
        
        <label>×“×’×</label>
        <input id="model" list="model-list" placeholder="×‘×—×¨ ××• ×”×§×œ×“ ×“×’×..." disabled>
        <datalist id="model-list"></datalist>
        
        <label>×©× ×”</label>
        <div class="year-picker-wrapper">
            <input type="text" id="year-display" class="year-display" placeholder="×œ×—×¥ ×œ×‘×—×™×¨×ª ×©× ×”" readonly onclick="toggleYearPopup()">
            <div id="year-popup" class="year-popup">
                <div class="year-header">
                    <span class="year-nav" onclick="changeYearPage(-1)">â®</span>
                    <span id="year-range-title">2020 - 2031</span>
                    <span class="year-nav" onclick="changeYearPage(1)">â¯</span>
                </div>
                <div id="year-grid" class="year-grid"></div>
            </div>
            <input type="hidden" id="year">
        </div>
        
        <button class="btn btn-ai" onclick="analyzeAI()">ğŸš€ ×”×¤×¢×œ × ×™×ª×•×— AI</button>
    </div>

    <div id="ai-result"></div>
</div>

<div id="screen-check" class="container" style="display:none">
    <h2 id="check-header" style="text-align:center; color:#fff; margin-bottom:20px;"></h2>
    <div id="checklist-content"></div>
    <button class="btn" style="background:var(--success); color:#000; margin-top:30px;" onclick="calculateScore()">ğŸ“Š ×©×§×œ×œ ×¦×™×•×Ÿ</button>
    <button class="btn" style="background:transparent; border:1px solid #444; color:#888; margin-top:15px;" onclick="location.reload()">×‘×™×˜×•×œ</button>
</div>

<div id="score-overlay">
    <div class="score-circle" id="final-score">0</div>
    <h2 id="score-msg" style="color:white; margin:0; font-size:24px;"></h2>
    <p id="score-desc" style="color:var(--text-muted); max-width:300px; margin-bottom:40px; line-height:1.6;"></p>
    <button class="btn" style="background:#25D366;" onclick="shareResult()">×©×ª×£ ×‘×•×•××˜×¡××¤ ğŸŸ¢</button>
    <button class="btn" style="background:transparent; border:1px solid #555; margin-top:15px;" onclick="location.reload()">×‘×“×™×§×” ×—×“×©×”</button>
</div>

<script>
// --- ×××’×¨ ×”× ×ª×•× ×™× ×”××œ× ---
const carDatabase = {
    "×××•×“×™": ["A1", "A3", "A4", "A5", "A6", "Q2", "Q3", "Q5", "Q7", "e-tron"],
    "××•×¤×œ": ["×§×•×¨×¡×”", "××¡×˜×¨×”", "××•×§×”", "×§×¨×•×¡×œ× ×“", "×’×¨× ×“×œ× ×“"],
    "×‘.×.×•×•": ["×¡×“×¨×” 1", "×¡×“×¨×” 3", "×¡×“×¨×” 5", "X1", "X3", "X5", "X6", "iX"],
    "×”×•× ×“×”": ["×’'××–", "×¡×™×•×•×™×§", "××§×•×¨×“", "HR-V", "CR-V"],
    "×•×•×œ×•×•": ["V40", "S60", "XC40", "XC60", "XC90"],
    "×˜×•×™×•×˜×”": ["××™×™×’×•", "×™××¨×™×¡", "×§×•×¨×•×œ×”", "×¤×¨×™×•×¡", "C-HR", "RAV4", "×œ× ×“ ×§×¨×•×–×¨", "×”×™×™×œ×§×¡"],
    "×˜×¡×œ×”": ["Model 3", "Model Y", "Model S", "Model X"],
    "×™×•× ×“××™": ["i10", "i20", "i30", "××™×•× ×™×§", "××œ× ×˜×¨×”", "×¡×•× ×˜×”", "×•× ×™×•", "×§×•× ×”", "×˜×•×¡×•×Ÿ", "×¡× ×˜×” ×¤×”"],
    "×××–×“×”": ["2", "3", "6", "CX-3", "CX-30", "CX-5", "CX-9", "MX-5"],
    "××™×¦×•×‘×™×©×™": ["×¡×¤×™×™×¡ ×¡×˜××¨", "××˜×¨××–'", "ASX", "××§×œ×™×¤×¡ ×§×¨×•×¡", "×××•×˜×œ× ×“×¨"],
    "××¨×¦×“×¡": ["A-Class", "C-Class", "E-Class", "CLA", "GLA", "GLC", "GLE"],
    "× ×™×¡××Ÿ": ["××™×§×¨×”", "×’'×•×§", "×¡× ×˜×¨×”", "×§×©×§××™", "××§×¡-×˜×¨×™×™×œ"],
    "×¡×•×–×•×§×™": ["××™×’× ×™×¡", "×¡×•×•×™×¤×˜", "×•×™×˜××¨×”", "×§×¨×•×¡××•×‘×¨", "×’'×™×× ×™"],
    "×¡×™××˜": ["××™×‘×™×–×”", "×œ××•×Ÿ", "××¨×•× ×”", "××˜×§×”"],
    "×¡×§×•×“×”": ["×¤××‘×™×”", "×¡×§××œ×”", "××•×§×˜×‘×™×”", "×¡×•×¤×¨×‘", "×§×××™×§", "×§××¨×•×§", "×§×•×“×™××§", "×× ×™××§"],
    "×¤×•×œ×§×¡×•×•×’×Ÿ": ["×¤×•×œ×•", "×’×•×œ×£", "×’'×˜×”", "×¤××¡××˜", "×˜×™-×§×¨×•×¡", "×˜×™-×¨×•×§", "×˜×™×’×•××Ÿ", "×˜×•××¨×’"],
    "×¤×™×’'×•": ["208", "2008", "3008", "5008"],
    "×§×™×”": ["×¤×™×§× ×˜×•", "×¨×™×•", "×¡×˜×•× ×™×§", "×¡×™×“", "×¤×•×¨×˜×”", "× ×™×¨×•", "×¡×œ×˜×•×¡", "×¡×¤×•×¨×˜××–'", "×¡×•×¨× ×˜×•", "×§×¨× ×™×‘×œ"],
    "×¨× ×•": ["×§×œ×™××•", "×§×¤×¦'×•×¨", "××’××Ÿ", "×’×¨× ×“ ×§×•×¤×”", "××¨×§× ×”", "××•×¡×˜×¨×œ"],
    "×©×‘×¨×•×œ×˜": ["×¡×¤××¨×§", "×××œ×™×‘×•", "×˜×¨××§×¡", "××§×•×•×™× ×•×§×¡", "×˜×¨××•×•×¨×¡"]
};

const checklistData = {
    "×× ×•×¢": [{name:"×˜×—×™× ×” ×‘×©××Ÿ",tip:"×‘×“×•×§ ××“×™×“"},{name:"× ×•×–×œ ×§×™×¨×•×¨",tip:"×¦×‘×¢ ×ª×§×™×Ÿ?"},{name:"× ×–×™×œ×•×ª",tip:"×—×¤×© ×©××Ÿ ×˜×¨×™"},{name:"×¨×¢×© ×× ×•×¢",tip:"×ª×§×ª×•×§×™×?"}],
    "×’×™×¨ ×•×©×œ×“×”": [{name:"××›×•×ª ×‘×’×™×¨",tip:"×‘×©×™×œ×•×‘ ×”×™×œ×•×š"},{name:"×”×—×œ×§×”",tip:"×‘×–××Ÿ ×”××¦×”"},{name:"×ª××•× ×•×ª",tip:"×”×¤×¨×©×™ ×¦×‘×¢"},{name:"×¦××™×’×™×",tip:"×™×‘×©×™×?"}],
    "×—×©××œ": [{name:"××–×’×Ÿ",tip:"×”×× ××§×¨×¨?"},{name:"× ×•×¨×•×ª ××–×”×¨×”",tip:"×™×© × ×•×¨×•×ª ×“×•×œ×§×•×ª?"},{name:"×—×œ×•× ×•×ª",tip:"×¢×•×œ×™× ×•×™×•×¨×“×™×?"}]
};

// --- ×˜×¢×™× ×ª ×“×£ ×•×”×’×“×¨×ª ×©×“×•×ª ---
document.addEventListener('DOMContentLoaded', function() {
    // ××™×œ×•×™ ×™×¦×¨× ×™×
    const brandSel = document.getElementById('brand');
    Object.keys(carDatabase).sort().forEach(b => {
        const opt = document.createElement('option');
        opt.value = b;
        opt.innerText = b;
        brandSel.appendChild(opt);
    });
});

function updateModels() {
    const b = document.getElementById('brand').value;
    const list = document.getElementById('model-list');
    const input = document.getElementById('model');
    list.innerHTML = ''; 
    input.value = '';
    
    if(b && carDatabase[b]) { 
        input.disabled = false; 
        carDatabase[b].forEach(m => {
            const opt = document.createElement('option');
            opt.value = m;
            list.appendChild(opt);
        });
    } else { 
        input.disabled = true; 
    }
}

// --- Year Picker Logic ---
let currentYearPage = 2020;

function toggleYearPopup() {
    const popup = document.getElementById('year-popup');
    if (popup.style.display === 'block') {
        popup.style.display = 'none';
    } else {
        renderYearGrid();
        popup.style.display = 'block';
    }
}

function renderYearGrid() {
    const grid = document.getElementById('year-grid');
    const rangeTitle = document.getElementById('year-range-title');
    const selectedYear = document.getElementById('year').value;
    grid.innerHTML = '';
    
    const endYear = currentYearPage + 11;
    rangeTitle.innerText = `${currentYearPage} - ${endYear}`;

    for (let y = currentYearPage; y <= endYear; y++) {
        const cell = document.createElement('div');
        cell.className = 'year-cell';
        cell.innerText = y;
        if (y == selectedYear) cell.classList.add('selected');
        
        cell.onclick = function() {
            document.getElementById('year').value = y;
            document.getElementById('year-display').value = y; // ××¢×“×›×Ÿ ××ª ×”×©×“×” ×”×•×™×–×•××œ×™
            document.getElementById('year-popup').style.display = 'none';
        };
        grid.appendChild(cell);
    }
}

function changeYearPage(direction) {
    currentYearPage += (direction * 12);
    renderYearGrid();
}

// ×¡×’×™×¨×ª ×¤×•×¤-××¤ ×‘×œ×—×™×¦×” ×‘×—×•×¥
window.onclick = function(event) {
    if (!event.target.matches('.year-display') && !event.target.closest('.year-popup') && !event.target.closest('.year-nav')) {
        document.getElementById('year-popup').style.display = 'none';
    }
}

// --- ×©×œ×™×¤×ª × ×ª×•× ×™× ×•-AI ---
async function superSearch() {
    let p = document.getElementById('plate').value.replace(/\D/g,'');
    if(p.length < 7) return alert("××¡×¤×¨ ×©×’×•×™");
    document.getElementById('loader').style.display = 'flex';
    document.getElementById('status-msg').innerHTML = "";
    
    try {
        const url = `https://data.gov.il/api/3/action/datastore_search?resource_id=053ad243-5e8b-4334-8397-47883b740881&filters={"mispar_rechev":"${p}"}`;
        const res = await fetch(`https://corsproxy.io/?` + encodeURIComponent(url));
        const data = await res.json();
        
        if(data.result.records.length > 0) {
            const c = data.result.records[0];
            
            // ×¢×“×›×•×Ÿ ×©× ×” (×•×™×–×•××œ×™ ×•× ×¡×ª×¨)
            const yearVal = c.shnat_yitzur;
            document.getElementById('year').value = yearVal;
            document.getElementById('year-display').value = yearVal; 
            currentYearPage = Math.floor(yearVal / 12) * 12;

            // ×¢×“×›×•×Ÿ ×™×¦×¨×Ÿ ×•×“×’×
            let rawBrand = c.tozeret_nm || "";
            const brandSel = document.getElementById('brand');
            for(let i=0; i<brandSel.options.length; i++) {
                if(rawBrand.includes(brandSel.options[i].value) && brandSel.options[i].value !== "") {
                    brandSel.selectedIndex = i;
                    updateModels(); 
                    break;
                }
            }
            document.getElementById('model').value = c.kinuy_mishari || "";
            document.getElementById('status-msg').innerHTML = "<span style='color:var(--success)'>âœ… ×¨×›×‘ ××•×ª×¨!</span>";
        } else { 
            document.getElementById('status-msg').innerHTML = "<span style='color:var(--warning)'>âš ï¸ ×œ× × ××¦×, ×”×–×Ÿ ×™×“× ×™×ª</span>"; 
        }
    } catch(e) { 
        document.getElementById('status-msg').innerHTML = "<span style='color:var(--danger)'>âŒ ×©×’×™××ª ×ª×§×©×•×¨×ª</span>"; 
    } finally { 
        document.getElementById('loader').style.display = 'none'; 
    }
}

async function analyzeAI() {
    const b = document.getElementById('brand').value;
    const m = document.getElementById('model').value;
    const y = document.getElementById('year').value;
    
    if(!b || !m || !y) return alert("×—×¡×¨×™× ×¤×¨×˜×™× (×™×¦×¨×Ÿ, ×“×’×, ×©× ×”)");
    document.getElementById('loader').style.display = 'flex';
    
    try {
        const res = await fetch('/analyze-ai', { method: 'POST', headers: {'Content-Type': 'application/json'}, body: JSON.stringify({brand:b, model:m, year:y}) });
        const data = await res.json();
        
        if(data.success) {
            const ai = data.aiAnalysis;
            const resDiv = document.getElementById('ai-result');
            let color = ai.reliability_score >= 80 ? 'var(--success)' : (ai.reliability_score >= 60 ? 'var(--warning)' : 'var(--danger)');
            
            resDiv.innerHTML = `
                <div style="text-align:center; margin-bottom:20px;">
                    <div class="ai-gauge" style="border-color:${color}; color:${color}; box-shadow: 0 0 15px ${color};">${ai.reliability_score}</div>
                    <div style="font-size:14px; color:var(--text-muted)">×¦×™×•×Ÿ ×××™× ×•×ª</div>
                </div>
                <div class="ai-card card-info"><h3>ğŸ“Œ ×¡×™×›×•×</h3><p style="color:#fff;">${ai.summary}</p></div>
                <div class="ai-card card-bad"><h3>âš ï¸ ××—×œ×•×ª</h3><ul>${ai.common_faults.map(f=>`<li>${f}</li>`).join('')}</ul></div>
                <div class="ai-card card-good"><h3>âœ… ×™×ª×¨×•× ×•×ª</h3><ul>${ai.pros.map(p=>`<li>${p}</li>`).join('')}</ul></div>
                <button class="btn" style="margin-top:20px; background:#222; border:1px solid #444;" onclick="goToChecklist()">×”××©×š ×œ×‘×“×™×§×” ×¤×™×–×™×ª â”</button>
            `;
            resDiv.style.display = 'block';
            setTimeout(() => resDiv.scrollIntoView({behavior:"smooth"}), 100);
        }
    } catch(e) { 
        alert("AI ×œ× ×–××™×Ÿ ×›×¨×’×¢. ×¢×•×‘×¨×™× ×œ×‘×“×™×§×” ×™×“× ×™×ª."); 
        goToChecklist(); 
    } finally { 
        document.getElementById('loader').style.display = 'none'; 
    }
}

// --- × ×™×•×•×˜ ×•×¦'×§ ×œ×™×¡×˜ ---
function goToChecklist() {
    document.getElementById('screen-input').style.display = 'none';
    document.getElementById('screen-check').style.display = 'block';
    const b = document.getElementById('brand').value;
    const m = document.getElementById('model').value;
    document.getElementById('check-header').innerText = `${b} ${m}`;
    
    let h = "";
    let i = 0;
    for(let cat in checklistData) {
        h += `<div class="category">${cat}</div>`;
        checklistData[cat].forEach(item => { 
            i++; 
            h += `<div class="check-item">
                    <div style="display:flex;align-items:center;" onclick="toggleCB(${i})">
                        <div class="cb" id="cb_${i}"></div>
                        <span style="margin-right:10px; color:#fff;">${item.name}</span>
                    </div>
                    <div style="color:var(--primary); font-size:20px; cursor:pointer;" onclick="alert('${item.tip}')">?</div>
                  </div>`; 
        });
    }
    document.getElementById('checklist-content').innerHTML = h;
    window.scrollTo(0,0);
}

function toggleCB(id) { document.getElementById('cb_'+id).classList.toggle('checked'); }

function calculateScore() {
    const total = document.querySelectorAll('.cb').length;
    const checked = document.querySelectorAll('.cb.checked').length;
    const score = Math.max(0, 100 - Math.round((checked/total)*100));
    document.getElementById('final-score').innerText = score;
    const msg = document.getElementById('score-msg');
    
    if(score > 85) msg.innerText = "×¨×›×‘ ××•××œ×¥ âœ…";
    else if(score > 60) msg.innerText = "××¦×‘ ×¡×‘×™×¨ âš ï¸";
    else msg.innerText = "×œ× ××•××œ×¥ âŒ";
    
    document.getElementById('score-overlay').style.display = 'flex';
}

function shareResult() { 
    window.open(`https://wa.me/?text=${encodeURIComponent('×ª×•×¦××ª ×‘×“×™×§×”: '+document.getElementById('final-score').innerText)}`); 
}
</script>
</body>
</html>
